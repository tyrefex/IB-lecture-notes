\documentclass[12pt]{article}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage[a4paper]{geometry}
\usepackage{fancyhdr}
\usepackage{tikz}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{amsthm}
\usepackage{import}
\usepackage{xifthen}
\usepackage{pdfpages}
\usepackage{transparent}
\usepackage{adjustbox}
\usepackage[shortlabels]{enumitem}
\usepackage{parskip}
\makeatletter
\newcommand{\@minipagerestore}{\setlength{\parskip}{\medskipamount}}
\makeatother
\usepackage{imakeidx}

\DeclareMathOperator{\Ker}{Ker}
\DeclareMathOperator{\Img}{Im}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\nullity}{null}
\DeclareMathOperator{\spn}{span}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\adj}{adj}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\Sym}{Sym}
\DeclareMathOperator{\Orb}{Orb}
\DeclareMathOperator{\Stab}{Stab}
\DeclareMathOperator{\ccl}{ccl}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\Syl}{Syl}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\Fit}{Fit}
\DeclareMathOperator{\Ann}{Ann}
\DeclareMathOperator{\epi}{epi}


\newcommand{\incfig}[1]{%
	\def\svgwidth{\columnwidth}
	\import{./figures/}{#1.pdf_tex}
}
\newcommand{\diff}{\mathop{}\!\mathrm{d}}
\newcommand{\Diff}[1]{\mathop{}\!\mathrm{d}^{#1}}

\setlength\parindent{0pt}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{corollary}{Corollary}[section]
\newtheorem{lemma}{Lemma}[section]
\newtheorem{proposition}{Proposition}[section]

\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]
\newtheorem{example}{Example}[section]

\theoremstyle{remark}
\newtheorem*{remark}{Remark}

\pagestyle{fancy}
\fancyhf{}
\rhead{\leftmark}
\lhead{Page \thepage}
\setlength{\headheight}{15pt}

\makeindex[intoc]

\usepackage{hyperref}
\hypersetup{
    colorlinks,
    citecolor=black,
    filecolor=black,
    linkcolor=black,
    urlcolor=black
}

\newcommand{\mapsfrom}{\mathrel{\reflectbox{\ensuremath{\mapsto}}}}

\begin{document}

\hypersetup{pageanchor=false}
\begin{titlepage}
	\begin{center}
		\vspace*{1em}
		\Huge
		\textbf{IB Methods}

		\vspace{1em}
		\large
		Ishan Nath, Michaelmas 2022

		\vspace{1.5em}

		\Large

		Based on Lectures by Prof. Edward Shellard

		\vspace{1em}

		\large
		\today
	\end{center}
	
\end{titlepage}
\hypersetup{pageanchor=true}

\tableofcontents

\newpage

\part{Self-Adjoint ODE'S}%
\label{prt:self_adjoint_ode_s}

\section{Fourier Series}%
\label{sec:fourier_series}

\subsection{Periodic Functions}%
\label{sub:periodic_functions}

A function $f(x)$ is \textbf{periodic}\index{periodic function} if
\[
	f(x + T) = f(x)
,\]
where $T$ is the period.

\begin{adjustbox}{minipage = \columnwidth - 25.5pt, margin=1em, frame=1pt, margin=0em}
	\begin{example} Consider simple harmonic motion. We have
\[
y = A \sin \omega t
,\]
where $A$ is the amplitude and the period $T = 2 \pi / \omega$, with angular frequency $\omega$.
\end{example}
\end{adjustbox}

Consider the set of functions
\[
	g_n(x) = \cos \frac{n \pi x}{L}, \quad h_n(x) = \sin \frac{n \pi x}{L}
,\]
which are periodic on the interval $0 \leq x < 2L$. Recall the identities
\begin{align*}
	\cos A \cos B &= \frac{1}{2} \left(\cos(A - B) + \cos (A + B) \right), \\
	\sin A \sin B &= \frac{1}{2} \left( \cos(A - B) - \cos(A + B) \right), \\
	\sin A \cos B &=  \frac{1}{2} \left( \sin(A - B) + \sin(A + B) \right).
\end{align*}

Define the \textbf{inner product}\index{inner product} for two periodic functions $f, g$ on the interval $[0, 2L)$ 
\[
	\langle f, g \rangle = \int_{0}^{2L}f(x) g(x)\diff x
.\]
I claim that the functions $g_n, h_m$ are \textbf{mutually orthogonal}. Indeed,
\begin{align*}
	\langle h_n, h_m \rangle &= \int_{0}^{2L} \sin \frac{n \pi x}{L} \sin \frac{m \pi x}{L}\diff x \\
				 &= \frac{1}{2} \int_{0}^{2L} \left( \cos \frac{(n - m)\pi x}{L} - \cos \frac{(n + m)\pi x}{L}\right)\diff x \\
				 &= \frac{1}{2} \frac{L}{\pi} \left[ \frac{\sin (n - m) \pi x/L}{n - m} - \frac{\sin (n + m) \pi x/L}{n + m} \right]_{0}^{2L} = 0.
\end{align*}
This works for $n \neq m$. For $n = m$,
\begin{align*}
	\langle h_n, h_n \rangle &= \int_{0}^{2L} \sin^2 \frac{n \pi x}{L}\diff x \\
				 &= \frac{1}{2} \int_{0}^{2L} \left( 1 - \cos \frac{2 \pi n x}{L} \right)\diff x \\
				 &= L \;\; (n \neq 0).
\end{align*}
Hence, we can put these together to get
\[
	\langle h_n, h_m \rangle =
	\begin{cases}
		L \delta_{nm}, & \forall\,\! n, m \neq 0, \\
		0, & n = 0.
	\end{cases}
\] 
Similarly, we can show
\[
	\langle g_n, g_m \rangle =
	\begin{cases}
		L \delta_{nm}, & \forall\,\! n, m \neq 0, \\
		2L \delta_{0n}, &m = 0.
	\end{cases}
	\quad \text{ and } \; \langle h_n, g_m \rangle = 0
.\]

\subsection{Definition of Fourier series}%
\label{sub:definition_of_fourier_series}\index{Fourier series}

We can express any `well-behaved' periodic function $f(x)$ with period $2L$ as
\[
	f(x) = \frac{1}{2}a_0  + \sum_{n = 1}^{\infty} a_n \cos \frac{n \pi x}{L} + \sum_{n = 1}^{\infty}b_n \sin \frac{n \pi x}{L}
,\]

where $a_n, b_n$ are constant such that the right hand side is convergent for all $x$ where $f$ is continuous. At a discontinuity $x$, the Fourier series approaches the midpoint
\[
	\frac{1}{2} \left( f(x_{+}) + f(x_{-}) \right)
.\]
\subsubsection{Fourier Coefficients}%
\label{subsub:fourier_coefficients}\index{Fourier coefficients}

Consider the inner product
\[
	\langle h_m(x), f(x) \rangle = \int_{0}^{2L} \sin \frac{m \pi x}{L} f(x)\diff x = L b_m
,\]
by the orthogonality relations. Hence we find that
\begin{align*}
	b_n &= \frac{1}{L} \int_{0}^{2L}f(x) \sin \frac{n \pi x}{L}\diff x, \\
	a_n &= \frac{1}{L} \int_{0}^{2L}f(x) \cos \frac{n \pi x}{L}\diff x.
\end{align*}
\begin{remark}
	\begin{enumerate}[(i)]
		\item[]
		\item $a_n$ includes $n = 0$, since $\frac{1}{2} a_0$ is the \textbf{average}
			\[
				\langle f(x) \rangle = \frac{1}{2L} \int_{0}^{2L} f(x)\diff x
			.\]
		\item The range of integration is over one period, so we may take the integral over $[0, 2L)$ or $[-L, L)$.
		\item We can think of the Fourier series as a decomposition into harmonics. The simplest Fourier series are the sine and cosine functions.
	\end{enumerate}	
\end{remark}

\begin{adjustbox}{minipage = \columnwidth - 25.5pt, margin=1em, frame=1pt, margin=0em}
	\begin{example}[Sawtooth wave]\index{sawtooth wave}
\item
	Consider the function $f(x) = x$ for $-L \leq x < L$, periodic with period $T = 2L$. The cosine coefficients are
	\[
	a_n = \frac{1}{L} \int_{-L}^{L} x \cos \frac{n \pi x}{L}\diff x = 0
	,\]
	as $x \cos \omega x$ is odd. The sine coefficients are
	\begin{align*}
		b_n &= \frac{2}{L} \int_{0}^{L} x \sin \frac{n \pi x}{L}\diff x \\
		    &= -\frac{2}{n \pi} \left[ x \cos \frac{n \pi x}{L} \right]_{0}^{L} + \frac{2}{n \pi} \int_{0}^{L} \cos \frac{n \pi x}{L}\diff x \\
		    &= - \frac{2L}{n \pi} \cos n \pi + \frac{2L}{(n \pi)^2} \sin n \pi = \frac{2L}{n \pi }(-1)^{n+1}.
	\end{align*}
	
\end{example}

\end{adjustbox}

\begin{adjustbox}{minipage = \columnwidth - 25.5pt, margin=1em, frame=1pt, margin=0em}
	So the sawtooth Fourier series is
	\begin{align*}
		f(x) &= \frac{2L}{\pi} \sum_{n = 1}^{\infty} \frac{(-1)^{n+1}}{n} \sin \frac{n \pi x}{L} \\
		     &= \frac{2L}{\pi} \left( \sin \frac{\pi x}{L} - \frac{1}{2} \sin \frac{2 \pi x}{L} + \frac{1}{3} \sin \frac{3 \pi x}{L} - \cdots \right).
	\end{align*}

\end{adjustbox}

With Fourier series, we can construct functions with only finitely many discontinuities, the topologist's sine curve, and the Weierstrass function.

\subsection{The Dirichlet Conditions (Fourier's theorem)}%
\label{sub:the_dirichlet_conditions_fourier_s_theorem_}\index{Dirichlet conditions}

These are sufficiency conditions for a ``well-behaved'' function to have a unique Fourier series:

\begin{proposition}
	If $f(x)$ is a bounded periodic function (period $2L$) with a finite number of minima, maxima and discontinuities in $0 \leq x < 2L$, then the Fourier series converges to  $f(x)$ at all points where $f$ is continuous; at discontinuities the series converges to the midpoint.
\end{proposition}

\begin{remark}
	\begin{enumerate}[(i)]
		\item[]
		\item These are weak conditions (in contrast to Taylor series), but pathological functions are excluded, such as
			\[
				f(x) = \frac{1}{x}, \quad f(x) = \sin \frac{1}{x}, \quad f(x) =
				\begin{cases}
					0 & x \in \mathbb{Q},\\
					1 & x \not \in \mathbb{Q}.
				\end{cases}
			\]
		\item The converse is not true.
		\item The proof is difficult.
	\end{enumerate}
	
\end{remark}

\subsubsection{Convergence of Fourier Series}%
\label{subsub:convergence_of_fourier_series}

\begin{theorem}
	If $f(x)$ has continuous derivatives up to the $p$'th derivative, which is discontinuous, then the Fourier series converges as $\mathcal{O}(n^{-(p+1)})$.
\end{theorem}

\begin{adjustbox}{minipage = \columnwidth - 25.5pt, margin=1em, frame=1pt, margin=0em}
\begin{example}
	Take the square wave\index{square wave}, with $p = 0$.
	\[
		f(x) =
		\begin{cases}
			1 & 0 \leq x < 1, \\
			-1 & -1 \leq x < 0.
		\end{cases}
	\]
	The Fourier series is
	\[
		f(x) = 4 \sum_{m = 1}^{\infty} \frac{\sin (2m - 1) \pi x}{(2m - 1)\pi}
	.\]
	We now look at the general ``see-saw'' wave\index{see-saw wave}, with $p = 1$. Here
	\[
		f(x) =
		\begin{cases}
			x(1 - \xi) & 0 \leq x < \xi, \\
			\xi(1 - x) & \xi \leq x < 1
		\end{cases}
		\text{ on } 0 \leq x < 1,
	\]
	and odd for $-1 \leq x < 0$. The Fourier series is
	\[
		f(x) = 2 \sum_{n = 1}^{\infty} \frac{\sin n \pi \xi \sin n \pi x}{(n \pi)^2}
	.\]
	For $\xi = 1/2$, we have
	\[
		f(x) = 2 \sum_{m = 1}^{\infty}(-1)^{m+1} \frac{\sin (2m - 1) \pi x}{((2m - 1)\pi)^2}
	.\]
	For $p = 2$, take $f(x) = x(1-x)/2$ on $0 \leq x < 1$, and odd for $-1 \leq x < 0$. The Fourier series is
	\[
		f(x) = 4 \sum_{m = 1}^{\infty} \frac{\sin (2m - 1) \pi x}{((2m - 1)\pi)^3}
	.\]
	Consider $f(x) = (1 - x^2)^2$, for $p = 3$. Then $a_n = \mathcal{O}(n^{-4})$.
\end{example}

\end{adjustbox}

\subsubsection{Integration of Fourier Series}%
\label{subsub:integration_of_fourier_series}

It is always valid to integrate the Fourier series of $f(x)$ term-by-term to obtain
\[
	F(x) = \int_{-L}^{x} f(x)\diff x
,\]
because $F(x)$ satisfies the Dirichlet conditions if $f(x)$ does.

\subsubsection{Differentiation of Fourier Series}%
\label{subsub:differentiation_of_fourier_series}

Differentiation needs to be done with great care. Consider the square wave. We differentiate it to get
\[
	f'(x) = 4 \sum_{m = 1}^{\infty} \cos (2m - 1) \pi x
.\]
But this is unbounded.

\begin{theorem}
	If $f(x)$ is continuous and satisfies the Dirichlet conditions, and $f'(x)$ satisfies the Dirichlet conditions, then $f'(x)$ can be found by term-by-term differentiation of the Fourier series of $f(x)$.
\end{theorem}

\begin{adjustbox}{minipage = \columnwidth - 25.5pt, margin=1em, frame=1pt, margin=0em}
\begin{example}
	If we differentiate the see-saw with $\xi = 1/2$, then we get an offset square wave.
\end{example}

\end{adjustbox}

\subsection{Parseval's Theorem}%
\label{sub:parseval_s_theorem}\index{Parseval's theorem}

This gives the relation between the integral of the square of a function and the sum of the squares of the Fourier coefficients:

\begin{align*}
	\int_{0}^{2L}[f(x)]^2\diff x &= \int_{0}^{2L}\diff x \left[ \frac{1}{2} a_0 + \sum_{n}a_n \cos \frac{n \pi x}{L} + \sum_{n}b_n \sin \frac{n \pi x}{L} \right]^2 \\
				   &= \int_{0}^{2L}\diff x \left[ \frac{1}{4} a_0^2 + \sum_{n} a_n^2 \cos^2 \frac{n \pi x}{L} + \sum_{n} b_n^2 \sin^2 \frac{n \pi x}{L} \right]\\
				   &= L \left[ \frac{1}{2} a_0^2 + \sum_{n = 1}^{\infty} (a_n^2 + b_n^2) \right].
\end{align*}

This is also called the \textbf{completeness relation}\index{completeness relation} because the left hand side is always greater than equal to the right hand side if any basis is missing.

\begin{adjustbox}{minipage = \columnwidth - 25.5pt, margin=1em, frame=1pt, margin=0em}
\begin{example}
	Take the sawtooth wave. We have
	\[
	LHS = \int_{-L}^{L} x^2\diff x = \frac{2}{3}L^3
	,\]
	\[
	RHS = L \sum_{n = 1}^{\infty} \frac{4L^2}{n^2 \pi^2} = \frac{4L^3}{\pi ^2}\sum_{n = 1}^{\infty} \frac{1}{n^2}
	.\]

\end{example}

\end{adjustbox}

\begin{adjustbox}{minipage = \columnwidth - 25.5pt, margin=1em, frame=1pt, margin=0em}
Therefore, we obtain
\[
\sum_{n = 1}^{\infty} \frac{1}{n^2} = \frac{\pi^2}{6}
.\]
\end{adjustbox}

\subsection{Alternative Fourier Series}%
\label{sub:alternative_fourier_series}

\subsubsection{Half-range Series}%
\label{subsub:half_range_series}\index{half-range series}

Consider $f(x)$ defined only on $0 \leq x < L$. Then we can extend its range over $- L \leq x < L$ in two simple ways:
\begin{enumerate}[(i)]
	\item Require it to be odd, so $f(-x) = -f(x)$. Then $a_n = 0$, and
		\[
			b_n = \frac{2}{L} \int_{0}^{L} \sin \frac{n \pi x}{L}\diff x
		.\]
		This is a Fourier sine series.
	\item Require it to be even, so $f(-x) = f(x)$. Then $b_n = 0$,
		\[
			a_n = \frac{2}{L} \int_{0}^{L}f(x) \cos \frac{n \pi x}{L}\diff x
		.\]
		This is a Fourier cosine series.
\end{enumerate}

\subsubsection{Complex Representation}%
\label{subsub:complex_representation}

Recall that
\[
	\cos \frac{n \pi x}{L} = \frac{1}{2} \left( e^{i n \pi x/L} + e^{-i n \pi x/L}\right), \quad \sin \frac{n \pi x}{L} = \frac{1}{2i} \left(e^{i n \pi x/L} - e^{-i n \pi x/L}\right)
.\]
So our Fourier series becomes
\begin{align*}
	f(x) &= \frac{1}{2} a_0 + \sum_{n = 1}^{\infty}a_n \cos \frac{n \pi x}{L} + \sum_{n = 1}^{\infty} b_n \sin \frac{n \pi x}{L} \\
	     &= \frac{1}{2} a_0 + \frac{1}{2} \sum_{n = 1}^{\infty}(a_n - i b_n) e^{i n \pi x/L} + \frac{1}{2} \sum_{n = 1}^{\infty}(a_n + i b_n) e^{-i n \pi x/L} \\
	     &= \sum_{m = -\infty}^{\infty} c_m e^{i m \pi x/L}.
\end{align*}
The coefficients $c_m$ satisfy
\[
c_m =
\begin{cases}
	\frac{1}{2}(a_{m} - ib_{m}) & m > 0, \\
	\frac{1}{2} a_0 & m = 0, \\
	\frac{1}{2}(a_{-m} + i b_{-m}) & m < 0.
\end{cases}
\]
Equivalently,
\[
	c_m = \frac{1}{2L}\int_{-L}^{L}f(x) e^{-i m \pi x/L}\diff x
.\]
Our inner product in the complex representation is
\[
	\langle f, g \rangle = \int f^{\ast}g \diff x
.\]
This is orthogonal, as
\[
\int_{-L}^{L} e^{-i m \pi x/L}e^{i n \pi x/L} \diff x = 2L \delta_{mn}
,\]
and satisfies Parseval's theorem as a result:
\[
	\int_{-L}^{L}|f(x)|^2\diff x = 2L \sum_{m = -\infty}^{\infty}|c_m|^2
.\]

\subsection{Fourier Series Motivations}%
\label{sub:fourier_series_motivations}

\subsubsection{Self-adjoint matrices}%
\label{subsub:self_adjoint_matrices}

Suppose $\mathbf{u}, \mathbf{v}$ are complex $N$-vectors with inner product $\langle \mathbf{u}, \mathbf{v} \rangle = \mathbf{u}^{\dagger} \mathbf{v}$. Then matrix $A$ is self-adjoint\index{self-adjoint matrix} (or Hermitian\index{Hermitian matrix}) if
\[
	\langle A \mathbf{u}, \mathbf{v} \rangle = \langle \mathbf{u}, A \mathbf{v} \rangle \implies A^{\dagger} = A
.\]
The eigenvalues $\lambda_1, \ldots, \lambda_N$ of $A$ satisfy the following properties:
\begin{enumerate}[(i)]
	\item The eigenvalues are real: $\lambda_n^{\ast} = \lambda_n$.
	\item If $\lambda_n \neq \lambda_m$, then their respective eigenvectors are orthogonal: $\langle \mathbf{v}_n, \mathbf{v}_m \rangle = 0$.
	\item If we rescale our eigenvectors then $\{\mathbf{v}_1, \ldots, \mathbf{v}_N\}$ form an orthonormal basis.
\end{enumerate}

Given $\mathbf{b}$, we can try to solve for $\mathbf{x}$ in $A \mathbf{x} = \mathbf{b}$. Express 
\[
	\mathbf{b} = \sum_{n = 1}^{N} b_n \mathbf{v}_n, \quad \mathbf{x} = \sum_{n = 1}^{N} c_n \mathbf{v}_n
.\]
Substituting into the equation,
\begin{align*}
	A \mathbf{x} &= \sum_{n = 1}^{N} A c_n \mathbf{v}_n = \sum_{n = 1}^{N} c_n \lambda_n \mathbf{v}_n, \\
	\mathbf{b} &= \sum_{n = 1}^{N} b_n \mathbf{v}_n.
\end{align*}
Equating and using orthogonality,
\[
c_n \lambda_n = b_n \implies c_n = \frac{b_n}{\lambda_n}
.\]
Hence the solution is
\[
\mathbf{x} = \sum_{n = 1}^{N}\frac{b_n}{\lambda_n} \mathbf{v}_n
.\]

\subsubsection{Solving inhomogeneous ODE with Fourier series}%
\label{subsub:solving_inhomogeneous_ode_with_fourier_series}

Take the following problem: We wish to find $y(x)$ given $f(x)$ for which
\[
	\mathcal{L}(y) = - \frac{\Diff2 y}{\diff x^2} = f(x)
,\]
subject to the boundary conditions $y(0) = y(L) = 0$. The related eigenvalue problem is 
\[
	\mathcal{L}y_n = \lambda_n y_n, \quad y_n(0) = y_n(L) = 0
.\]
This has eigenfunctions and eigenvalues
\[
	y_n(x) = \sin \frac{n \pi x}{L}, \quad \lambda_n = \left( \frac{n \pi}{L} \right)^2
.\]
Note that $\mathcal{L}$ is a self-adjoint ODE with orthogonal eigenfunctions. Thus we seek solutions as a half-range sine series. We try
\[
	y(x) = \sum_{n = 1}^{\infty} c_n \sin \frac{n \pi x}{L},
\]
and expand
\[
	f(x) = \sum_{n = 1}^{\infty} b_n \sin \frac{n \pi x}{L}
.\]
Substituting this in,
\begin{align*}
	\mathcal{L}y &= - \frac{\Diff2}{\diff x^2} \left( \sum_{n} c_n \sin \frac{n \pi x}{L} \right) = \sum_{n = 1}^{\infty} c_n \left(\frac{n \pi}{L} \right)^2 \sin \frac{n \pi x}{L} \\
		     &= \sum_{n = 1}^{\infty} b_n \sin \frac{n \pi x}{L}.
\end{align*}
By orthogonality, we have
\[
	c_n \left( \frac{n \pi}{L}\right)^2 = b_n \implies c_n = \left( \frac{L}{n \pi} \right)^2
.\]
Thus the solution is
\[
	y(x) = \sum_{n = 1}^{\infty} \left( \frac{L}{n \pi}\right)^2 b_n \sin \frac{n \pi x}{L} = \sum_{n = 1}^{\infty} \frac{b_n}{\lambda_n} y_n
.\]
This is similar to a self-adjoint matrix.

\begin{adjustbox}{minipage = \columnwidth - 25.5pt, margin=1em, frame=1pt, margin=0em}
\begin{example}
	Consider the square wave on $L = 1$, as an odd function. This has Fourier series
	\[
		f(x) = 4 \sum_{m} \frac{\sin (2m - 1)\ pi x}{(2m - 1)\pi}
	.\]
	So the solution should be
	\[
		y(x) = \sum \frac{b_n}{\lambda_n} y_n = 4 \sum_{m} \frac{\sin (2m - 1)\pi x}{((2m -1)\pi)^3}
	.\]
	This is the Fourier series for $y(x) = x(1-x)/2$.
\end{example}

\end{adjustbox}



\newpage

\printindex

\end{document}
